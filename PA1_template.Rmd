# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data

```{r results='hide'}
library(data.table)
data <- data.table(read.csv(unz('activity.zip', 'activity.csv')))

# Convert character strings representing dates into date objects:
data[,date:=as.Date(date)]
```

## What is mean total number of steps taken per day?

```{r results='asis'}
daily.steps <- data[,sum(steps),by=date][,na.omit(V1)]
hist(daily.steps,xlab='Steps/day', main="Histogram of steps per day")

library(xtable)
print(xtable(data.frame(Mean=mean(daily.steps), Median=median(daily.steps))), type='html')
```

## What is the average daily activity pattern?

```{r}
daily.pattern <- data[,list(steps=mean(steps,na.rm=T)),by=interval]
plot(daily.pattern,type='l',
     xlab='Time of day (in five minute intervals)',
     ylab='Average number of steps'
     )
```

The 5-minute interval that, on average across all the days in the dataset, contains the maximum number of steps:
```{r}
daily.pattern[which.max(steps)]$interval
```


## Imputing missing values

Total number of missing values in the dataset:

```{r}
data[is.na(steps),.N]
```

The strategy chosen for filling in all of the missing values in the dataset is to take the mean for that 5-minute interval across all days.

```{r results='hide'}
data[,imputed:=mean(steps,na.rm=T),by=interval]
data[!is.na(steps), imputed:=steps]
```

```{r}
hist(data[,sum(imputed),by=date][,V1],xlab='Steps/day', main="Histogram of steps per day")
```


## Are there differences in activity patterns between weekdays and weekends?

```{r}
daily.pattern.panel <- data[,weekend := weekdays(date,abbreviate = T) %in% c('Sat', 'Sun')][,list(steps=mean(steps,na.rm=T)),by=list(interval,weekend)]
backup <- par(mfrow=c(2,1))
plot(daily.pattern.panel[weekend==T,list(interval,steps)],type='l',
     xlab='Time of day (in five minute intervals)',
     ylab='Average number of steps',
     main='Weekend'
     )
plot(daily.pattern.panel[weekend==F,list(interval,steps)],type='l',
     xlab='Time of day (in five minute intervals)',
     ylab='Average number of steps',
     main='Weekdays'
     )
par <- backup
```

